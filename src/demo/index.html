<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>WebSR Demo</title>
    <script src="websr.js" type="application/javascript"></script>
</head>
<body>

<img id="img" src="test.png" />
<canvas id="canvas" width="256" height="256"></canvas>
<canvas id="canvas2" width="512" height="512"></canvas>

<script>

    const workingCanvas = document.getElementById('canvas');
    const destinationCanvas = document.getElementById('canvas2')


    WebSR.initWebGPU().then(async function (gpu) {

        if(!gpu) return console.log("Unable to load WebGPU");

        const weights = await (await fetch('./anime4k-cnn-2x-s.json')).json()

        const websr = new WebSR("anime4k/cnn-2x-s", weights,  gpu, workingCanvas, destinationCanvas);

        console.log("Loaded WebSR", websr);

        const bitmap = await createImageBitmap(document.getElementById('img'));

        console.log("Feeding bitmap into WebSR");

        websr.loadImage(bitmap);

        console.log("Rendering");

        websr.render();


    });


</script>


</body>
</html>